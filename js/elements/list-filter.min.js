!function($,_undefined){"use strict";const abs=Math.abs;const max=Math.max;const min=Math.min;const urlManager=$ush.urlManager();const PREFIX_FOR_URL_PARAM='_';const FACETED_PARAM='_f';const RANGE_VALUES_BY_DEFAULT=[0,1000];const DELETE_FILTER=null;var hasFacetedFilters;function parseValues(values){values=$ush.toString(values);if(!values||!values.includes('-')){return RANGE_VALUES_BY_DEFAULT}
return values.split('-').map($ush.parseFloat)}
function usListFilter(container){const self=this;self._events={applyFilterToList:$ush.debounce(self.applyFilterToList.bind(self),1),checkScreenStates:$ush.debounce(self.checkScreenStates.bind(self),10),closeMobileVersion:self.closeMobileVersion.bind(self),getItemValues:$ush.debounce(self.getItemValues.bind(self),0),hideItemDropdown:self.hideItemDropdown.bind(self),openMobileVersion:self.openMobileVersion.bind(self),resetItemValues:self.resetItemValues.bind(self),searchItemValues:self.searchItemValues.bind(self),toggleItemSection:self.toggleItemSection.bind(self),navUsingKeyPress:$ush.debounce(self.navUsingKeyPress.bind(self),0),};self.$container=$(container);self.$pageContent=$('main#page-content');if(!self.isVisible()){return}
self.$titles=$('.w-filter-item-title',self.$container);self.$listCloser=$('.w-filter-list-closer',self.$container);self.$opener=$('.w-filter-opener',self.$container);self.data={mobileWidth:600,listSelectorToFilter:null,ajaxData:{},};self.filters={};self.result={};self.lastResult;self.xhr;self.isFacetedFiltering=self.$container.hasClass('faceted_filtering');self.hidePostCount=self.$container.hasClass('hide_post_count');if(self.$container.is('[onclick]')){$.extend(self.data,self.$container[0].onclick()||{})}
$('.type_date_picker',self.$container).each((_,filter)=>{var $start=$('input:eq(0)',filter),$end=$('input:eq(1)',filter),$startContainer=$start.parent(),$endContainer=$start.parent(),startOptions={},endOptions={};if($startContainer.is('[onclick]')){startOptions=$startContainer[0].onclick()||{}}
if($endContainer.is('[onclick]')){endOptions=$endContainer[0].onclick()||{}}
$start.datepicker($.extend(!0,{isRTL:$ush.isRtl(),dateFormat:$start.data('date-format'),beforeShow:(_,inst)=>{inst.dpDiv.addClass('for_list_filter')},onSelect:()=>{$start.trigger('change')},onClose:(_,inst)=>{$end.datepicker('option','minDate',inst.input.datepicker('getDate')||null)},},startOptions));$end.datepicker($.extend(!0,{isRTL:$ush.isRtl(),dateFormat:$end.data('date-format'),beforeShow:(_,inst)=>{inst.dpDiv.addClass('for_list_filter')},onSelect:()=>{$start.trigger('change')},onClose:(_,inst)=>{$start.datepicker('option','maxDate',inst.input.datepicker('getDate')||null)},},endOptions))});$('.type_range_slider',self.$container).each((_,filter)=>{function showFormattedResult(_,ui){$('.for_min_value, .for_max_value',filter).each((i,node)=>{$(node).html(self.numberFormat(ui.values[i],opts))})}
const $slider=$('.ui-slider',filter);var opts={slider:{animate:!0,min:RANGE_VALUES_BY_DEFAULT[0],max:RANGE_VALUES_BY_DEFAULT[1],range:!0,step:10,values:RANGE_VALUES_BY_DEFAULT,slide:showFormattedResult,change:showFormattedResult,stop:$ush.debounce((_,ui)=>{$('input[type=hidden]',filter).val(ui.values.join('-')).trigger('change')}),},unitFormat:'%d',numberFormat:null,};if($slider.is('[onclick]')){opts=$.extend(!0,opts,$slider[0].onclick()||{})}
$slider.removeAttr('onclick').slider(opts.slider).fixSlider();$(filter).data('opts',opts)});if(self.changeURLParams()){$('[data-name]',self.$container).each((_,filter)=>{const $filter=$(filter);const compare=$ush.toString($filter.data('value-compare'));var name=$filter.data('name');if(compare){name+=`|${compare}`}
self.filters[name]=$filter});self.setupFields();urlManager.on('popstate',()=>{self.setupFields();self.applyFilterToList()})}
if(self.isFacetedFiltering&&!hasFacetedFilters){hasFacetedFilters=!0;self._events.itemsLoaded=(_,$items,applyFilter)=>{if(applyFilter&&self.isVisible()){self.setPostCount(self.firstListData().facetedFilter.post_count)}};$us.$document.on('usPostList.itemsLoaded',self._events.itemsLoaded);var listFilters={};$.each(self.filters,(name,$filter)=>{listFilters[name]=$ush.toString($filter.usMod('type'))});listFilters=JSON.stringify(listFilters);self.listToFilter().trigger('usListFilter',{list_filters:listFilters});self.$container.addClass('loading');const data=$.extend(!0,{list_filters:listFilters,_s:urlManager.get('_s'),},self.firstListData().facetedFilter,self.result,self.data.ajaxData);data[FACETED_PARAM]=1;self.xhr=$.ajax({type:'post',url:$us.ajaxUrl,dataType:'json',cache:!1,data:data,success:(res)=>{if(!res.success){console.error(res.data.message)}
self.setPostCount(res.success?res.data:{})},complete:()=>{self.$container.removeClass('loading')}})}
else if(!self.isFacetedFiltering&&urlManager.has(FACETED_PARAM,'1')){urlManager.remove(FACETED_PARAM).push()}
$('.w-filter-item',self.$container).on('change','input:not([name=search_values]), select',self._events.getItemValues).on('input change','input[name=search_values]',self._events.searchItemValues).on('click','.w-filter-item-reset',self._events.resetItemValues).on('click','.w-filter-item-title',self._events.toggleItemSection);self.$container.on('mouseup','.w-filter-opener',self._events.openMobileVersion).on('mouseup','.w-filter-list-closer, .w-filter-button-submit',self._events.closeMobileVersion).on('keydown',self._events.navUsingKeyPress);$us.$window.on('resize',self._events.checkScreenStates);if(self.titlesAsDropdowns()){$us.$document.on('click',self._events.hideItemDropdown)}
self.on('applyFilterToList',self._events.applyFilterToList);self.checkScreenStates();self.сheckActiveFilters()}
$.extend(usListFilter.prototype,$ush.mixinEvents,{titlesAsToggles:function(){return this.$container.hasClass('mod_toggle')},titlesAsDropdowns:function(){return this.$container.hasClass('mod_dropdown')},changeURLParams:function(){return this.$container.hasClass('change_url_params')},isVisible:function(){return this.$container.is(':visible')},setupFields:function(){const self=this;$.each(self.filters,(name,$filter)=>{self.resetFields($filter);name=PREFIX_FOR_URL_PARAM+name;if(!urlManager.has(name)){delete self.result[name];return}
var values=$ush.toString(urlManager.get(name));values.split(',').map((value,i)=>{if($filter.hasClass('type_dropdown')){$(`select`,$filter).val(value)}else if($filter.hasClass('type_date_picker')){var $input=$(`input:eq(${i})`,$filter);if($input.length&&/\d{4}-\d{2}-\d{2}/.test(value)){$input.val($.datepicker.formatDate($input.data('date-format'),$.datepicker.parseDate('yy-mm-dd',value)))}}else if($filter.hasClass('type_range_input')){if(/([\.?\d]+)-([\.?\d]+)/.test(value)){$('input',$filter).each((i,input)=>{input.value=parseValues(value)[i]})}}else if($filter.hasClass('type_range_slider')){if(!self.isFacetedFiltering&&/([\.?\d]+)-([\.?\d]+)/.test(value)){$('.ui-slider',$filter).slider('values',parseValues(value));$(`input[type=hidden]`,$filter).val(value)}}else{$(`input[value="${value}"]`,$filter).prop('checked',!0)}});self.result[name]=values;$filter.addClass('has_value').toggleClass('expand',self.titlesAsToggles()&&self.$container.hasClass('layout_ver'))});self.showSelectedValues()},searchItemValues:function(e){const $filter=$(e.delegateTarget);const $items=$('[data-value]',$filter);const value=$ush.toLowerCase(e.target.value).trim();$items.filter((_,node)=>{return!$('input',node).is(':checked')}).toggleClass('hidden',!!value);if($filter.hasClass('type_radio')){const $buttonAnyValue=$('[data-value="*"]:first',$filter);if(!$('input',$buttonAnyValue).is(':checked')){$buttonAnyValue.toggleClass('hidden',!$ush.toLowerCase($buttonAnyValue.text()).includes(value))}}
if(value){$items.filter((_,node)=>{return $ush.toLowerCase($(node).text()).includes(value)}).removeClass('hidden').length}
$('.w-filter-item-message',$filter).toggleClass('hidden',$items.is(':visible'))},getItemValues:function(e){const self=this;const $filter=$(e.target).closest('.w-filter-item');const compare=$filter.data('value-compare');var name=PREFIX_FOR_URL_PARAM+$ush.toString($filter.data('name')),value=e.target.value,isExpand;if(compare){name+=`|${compare}`}
if($filter.hasClass('type_checkbox')){var values=[];$('input:checked',$filter).each((_,input)=>{values.push(input.value)});if(!values.length){self.result[name]=DELETE_FILTER}else{self.result[name]=values.toString()}}else if($filter.hasClass('type_date_picker')){var values=[];$('input.hasDatepicker',$filter).each((i,input)=>{values[i]=$.datepicker.formatDate('yy-mm-dd',$(input).datepicker('getDate'))});if(!values.length){self.result[name]=DELETE_FILTER}else{self.result[name]=values.toString()}}else if($filter.hasClass('type_range_input')){var defaultValues=[],values=[];$('input',$filter).each((i,input)=>{defaultValues[i]=input.dataset.value;values[i]=input.value||defaultValues[i]});if(!values.length||values.toString()===defaultValues.toString()){self.result[name]=DELETE_FILTER}else{self.result[name]=values.join('-')}}else{if($ush.rawurldecode(value)==='*'){self.result[name]=DELETE_FILTER}else{self.result[name]=value}}
const hasValue=!!self.result[name];$filter.toggleClass('has_value',hasValue);if(self.isFacetedFiltering){$filter.siblings().addClass('loading')}
self.trigger('applyFilterToList');self.showSelectedValues()},listToFilter:function(){const self=this;var $lists;if(self.data.listSelectorToFilter){$lists=$(self.data.listSelectorToFilter,self.$pageContent)}else{$lists=$(`
					.w-grid.us_post_list:visible,
					.w-grid.us_product_list:visible,
					.w-grid-none:visible
				`,self.$pageContent).first()}
if($lists.hasClass('w-grid-none')){$lists=$lists.prev()}
return $lists},firstListData:function(){return $ush.toPlainObject((this.listToFilter().first().data('usPostList')||{}).data)},numberFormat:function(value,options){const self=this;const defaultOpts={unitFormat:'%d',numberFormat:null,};value=$ush.toString(value);options=$.extend(defaultOpts,$ush.toPlainObject(options));if(options.numberFormat){var numberFormat=$ush.toPlainObject(options.numberFormat),decimals=$ush.parseInt(abs(numberFormat.decimals));if(decimals){value=$ush.toString($ush.parseFloat(value).toFixed(decimals)).replace(/^(\d+)(\.)(\d+)$/,'$1'+numberFormat.decimal_separator+'$3')}
value=value.replace(/\B(?=(\d{3})+(?!\d))/g,numberFormat.thousand_separator)}
return $ush.toString(options.unitFormat).replace('%d',value)},setPostCount:function(data){const self=this;if(!$.isPlainObject(data)){data={}}
$.each(self.filters,(filterName,filter)=>{const $filter=$(filter);const currentData=$ush.clone(data[filterName.split('|',1)[0]]||{});const isRangeType=$filter.hasClass('type_range_slider')||$filter.hasClass('type_range_input');if($filter.hasClass('range_by_year')&&!isRangeType){for(const k in currentData){const year=$ush.toString(k).substring(0,4);currentData[year]=$ush.parseInt(currentData[year])+currentData[k]}}
var numActiveValues=0;if($filter.hasClass('type_checkbox')||$filter.hasClass('type_radio')){const compare=$filter.data('value-compare');$('[data-value]',filter).each((_,node)=>{const $node=$(node);const value=$node.data('value');if($filter.hasClass('type_radio')&&value==='*'){return}
var postCount=0;if(compare=='between'){const rangeValues=value.split('-').map($ush.parseFloat);$.each(data[filterName.split('|')[0]]||{},(val,count)=>{if(val>=rangeValues[0]&&val<=rangeValues[1]){postCount+=count}})}else{postCount=$ush.parseInt(currentData[value])}
if(postCount){numActiveValues++}
$node.toggleClass('disabled',postCount===0).data('post-count',postCount).find('.w-filter-item-value-amount').text(postCount);$('input',$node).prop('disabled',postCount===0)})}else if($filter.hasClass('type_dropdown')){$('.w-filter-item-value-select option',filter).each((_,node)=>{const $node=$(node);const $formattedValue=$ush.rawurldecode(node.value).replace(/\\/g,'').replace(/[\u201A]/g,',');const postCount=$ush.parseInt(currentData[$formattedValue]);if(postCount){numActiveValues++}
if(!self.hidePostCount&&$node.data('label-template')){$node.text($ush.toString($node.data('label-template')).replace('%d',postCount))}
$node.prop('disabled',postCount===0).toggleClass('disabled',postCount===0);$('select',$node).prop('disabled',postCount===0)})}else if(isRangeType){const minValue=$ush.parseFloat(currentData[0]);const maxValue=$ush.parseFloat(currentData[1]);const newValues=[minValue,maxValue];const currentValues=urlManager.get(`_${filterName}`);if(minValue){numActiveValues++}
if(maxValue){numActiveValues++}
if($filter.hasClass('type_range_slider')){$('.ui-slider',$filter).slider('option',{min:minValue,max:maxValue,values:currentValues?parseValues(currentValues):newValues,});$(`input[type=hidden]`,$filter).val(newValues.join('-'))}else{const opts=$('.for_range_input_options',filter)[0].onclick()||{};$('.for_min_value, .for_max_value',filter).each((i,node)=>{const formattedValue=self.numberFormat(newValues[i],opts);const $node=$(node);$node.attr('placeholder',$ush.fromCharCode(formattedValue))})}}else{numActiveValues=1}
const $focusableElements=$('input,select,button,.ui-slider-handle',filter);if(numActiveValues){$focusableElements.each((_,node)=>{const $node=$(node);if($node.hasClass('ui-slider-handle')){$node.attr('tabindex','0')}else{$node.removeAttr('tabindex')}})}else{$focusableElements.attr('tabindex','-1')}
$filter.removeClass('loading');$filter.toggleClass('disabled',numActiveValues<1)})},resetItemValues:function(e){const self=this;e.stopPropagation();e.preventDefault();const $filter=$(e.target).closest('.w-filter-item');const compare=$filter.data('value-compare');var name=PREFIX_FOR_URL_PARAM+$filter.data('name');if(compare){name+=`|${compare}`}
self.result[name]=DELETE_FILTER;self.trigger('applyFilterToList');self.resetFields($filter)},resetFields:function($filter){const self=this;if($filter.hasClass('type_checkbox')){$('input[type=checkbox]',$filter).prop('checked',!1)}else if($filter.hasClass('type_radio')){$('input[type=radio]',$filter).prop('checked',!1);$('input[value="%2A"]',$filter).prop('checked',!0)}else if($filter.hasClass('type_dropdown')){$('select',$filter).prop('selectedIndex',0)}else if($filter.hasClass('type_date_picker')||$filter.hasClass('type_range_input')){$('input',$filter).val('')}else if($filter.hasClass('type_range_slider')){var $input=$('input[type=hidden]',$filter),values=[$input.attr('min'),$input.attr('max')];$('.ui-slider',$filter).slider('values',values.map($ush.parseFloat))}
if(self.titlesAsDropdowns()){$('.w-filter-item-title span',$filter).text('')}
$filter.removeClass('has_value expand');$('input[name="search_values"]',$filter).val('');$('.w-filter-item-value',$filter).removeClass('hidden')},applyFilterToList:function(){const self=this;if(!$ush.isUndefined(self.lastResult)&&$ush.comparePlainObject(self.result,self.lastResult)){return}
self.lastResult=$ush.clone(self.result);self.сheckActiveFilters();const urlParams=$ush.clone(self.result);if(self.isFacetedFiltering){var f_value=DELETE_FILTER;for(const k in self.result){if(k!==FACETED_PARAM&&self.result[k]!==DELETE_FILTER){f_value=1;break}}
urlParams[FACETED_PARAM]=f_value;self.result[FACETED_PARAM]=1}
if(self.changeURLParams()){urlManager.set(urlParams);urlManager.push({})}
self.listToFilter().trigger('usListFilter',self.result)},toggleItemSection:function(e){const self=this;if(e.originalEvent.detail>0&&self.$container.hasClass('drop_on_hover')){return}
if(self.titlesAsToggles()||self.titlesAsDropdowns()){const $filter=$(e.delegateTarget);$filter.toggleClass('expand',!$filter.hasClass('expand'))}},openMobileVersion:function(){const self=this;$us.$body.addClass('us_filter_open');self.$container.addClass('open_for_mobile').attr('aria-modal','true');self.$opener.attr('tabindex','-1');if(self.titlesAsDropdowns()){self.$titles.attr('tabindex','-1')}},closeMobileVersion:function(){const self=this;$us.$body.removeClass('us_filter_open');self.$container.removeClass('open_for_mobile').removeAttr('aria-modal');self.$opener.removeAttr('tabindex');if(self.titlesAsDropdowns()){self.$titles.removeAttr('tabindex')}},showSelectedValues:function(){const self=this;if(!self.titlesAsDropdowns()){return}
for(const key in self.result){if(key===FACETED_PARAM){continue}
const name=(key.charAt(0)==='_')?key.substring(1):key;var value=self.result[key];if((self.lastResult||{})[key]===value||$ush.isUndefined(value)){continue}
const $filter=self.filters[name];const $label=$('.w-filter-item-title > span',$filter);if(value===null){$label.text('');continue}else{value=$ush.rawurldecode(value)}
if($filter.hasClass('type_dropdown')){$label.text($(`option[value="${value}"]`,$filter).text())}else if($filter.hasClass('type_range_slider')||$filter.hasClass('type_range_input')){const formattedLabel=$ush.toString(self.result[key]).split('-').map((v)=>self.numberFormat(v,$filter.data('opts'))).join(' - ');$label.text(`${$ush.fromCharCode( formattedLabel )}`)}else if($filter.hasClass('type_date_picker')){const values=[];$('input.hasDatepicker',$filter).each((_,input)=>{if(input.value){values.push(input.value)}});$label.text(values.join(' - '))}else{if(value.includes(',')&&value.split(',')[0].length>2){value=value.split(',').length}else{value=$(`[data-value="${value}"] .w-filter-item-value-label:first`,$filter).html()||value}
$label.text(value)}}},hideItemDropdown:function(e){const self=this;const $openedFilters=$('.w-filter-item.expand',self.$container);if(!$openedFilters.length){return}
$openedFilters.each((_,node)=>{const $node=$(node);if(!$node.is(e.target)&&$node.has(e.target).length===0){$node.removeClass('expand')}})},checkScreenStates:function(){const self=this;const isMobile=$ush.parseInt(window.innerWidth)<=$ush.parseInt(self.data.mobileWidth);if(!self.$container.hasClass(`state_${ isMobile ? 'mobile' : 'desktop' }`)){self.$container.usMod('state',isMobile?'mobile':'desktop');if(!isMobile){$us.$body.removeClass('us_filter_open');self.$container.removeClass('open_for_mobile')}}},сheckActiveFilters:function(){const self=this;self.$container.toggleClass('active',$('.has_value:first',self.$container).length>0)},});$.extend(usListFilter.prototype,{navUsingKeyPress:function(e){const self=this;const keyCode=e.keyCode;if(![$ush.TAB_KEYCODE,$ush.ENTER_KEYCODE,$ush.SPACE_KEYCODE,$ush.ESC_KEYCODE].includes(keyCode)){return}
const focusableSelectors=['a[href]','input:not([disabled])','select:not([disabled])','textarea:not([disabled])','button:not([disabled])','[tabindex]',].join();const $target=$(e.target);const $activeElement=$(_document.activeElement).filter(focusableSelectors);const isOpenMobileVersion=self.$container.hasClass('open_for_mobile');function openMobileVersion(){if($target.hasClass('w-filter-opener')){self.openMobileVersion();self.$listCloser[0].focus()}}
function closeMobileVersion(){self.closeMobileVersion();self.$opener[0].focus()}
if(keyCode===$ush.ESC_KEYCODE){$.each(self.filters,(_,$filter)=>{if($filter.hasClass('expand')){$filter.removeClass('expand');$('.w-filter-item-title',$filter)[0].focus()}});if(isOpenMobileVersion){closeMobileVersion()}}
if([$ush.ENTER_KEYCODE,$ush.SPACE_KEYCODE].includes(keyCode)){if($target.hasClass('w-filter-item-reset')){if(isOpenMobileVersion){$(focusableSelectors,$target.closest('[data-name]')).filter(':visible:not([tabindex="-1"]):eq(0)')[0].focus()}else{$('.w-filter-item-title',$target.closest('.w-filter-item'))[0].focus();self.resetItemValues(e)}}
openMobileVersion();if($target.hasClass('w-filter-list-closer')||$target.hasClass('w-filter-button-submit')){closeMobileVersion()}}
if(keyCode===$ush.TAB_KEYCODE){const isContainActiveElement=$.contains(self.$container[0],$activeElement[0]);if(self.titlesAsDropdowns()&&!isOpenMobileVersion&&!isContainActiveElement){$('.w-filter-item.expand',self.$container).removeClass('expand')}
if(isOpenMobileVersion&&!isContainActiveElement){const $focusable=$(focusableSelectors,self.$container).filter(':visible:not([tabindex="-1"])');if(!$focusable.length){e.preventDefault();self.$listCloser[0].focus();return}
const firstElement=$focusable.first()[0];const lastElement=$focusable.last()[0];if(e.shiftKey&&$target[0]===firstElement){e.preventDefault();lastElement.focus()}else if(!e.shiftKey&&$target[0]===lastElement){e.preventDefault();firstElement.focus()}}}},});$.fn.usListFilter=function(){return this.each((_,node)=>{$(node).data('usListFilter',new usListFilter(node))})};$(()=>$('.w-filter.for_list').usListFilter())}(jQuery);!function($,_undefined){"use strict";$.fn.fixSlider=function(){this.each((_,node)=>{const inst=$(node).slider('instance');inst._original_refreshValue=inst._refreshValue;inst._calculateNewMax=function(){this.max=this.options.max};inst._refreshValue=function(){const self=this;self._original_refreshValue();if(self._hasMultipleValues()){var isFixed=!1;self.handles.each((i,handle)=>{const valPercent=(self.values(i)-self._valueMin())/(self._valueMax()-self._valueMin())*100;if(isNaN(valPercent)){$(handle).css('left',`${i*100}%`);isFixed=!0}});if(isFixed){self.range.css({left:0,width:'100%'})}}}})}}(jQuery)